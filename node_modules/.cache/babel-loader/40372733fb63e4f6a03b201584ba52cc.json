{"ast":null,"code":"/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n'use strict';\n/**\n * Module dependencies.\n * @private\n */\n\nvar debug = require('debug')('express:view');\n\nvar path = require('path');\n\nvar fs = require('fs');\n/**\n * Module variables.\n * @private\n */\n\n\nvar dirname = path.dirname;\nvar basename = path.basename;\nvar extname = path.extname;\nvar join = path.join;\nvar resolve = path.resolve;\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = View;\n/**\n * Initialize a new `View` with the given `name`.\n *\n * Options:\n *\n *   - `defaultEngine` the default template engine name\n *   - `engines` template engine require() cache\n *   - `root` root path for view lookup\n *\n * @param {string} name\n * @param {object} options\n * @public\n */\n\nfunction View(name, options) {\n  var opts = options || {};\n  this.defaultEngine = opts.defaultEngine;\n  this.ext = extname(name);\n  this.name = name;\n  this.root = opts.root;\n\n  if (!this.ext && !this.defaultEngine) {\n    throw new Error('No default engine was specified and no extension was provided.');\n  }\n\n  var fileName = name;\n\n  if (!this.ext) {\n    // get extension from default engine name\n    this.ext = this.defaultEngine[0] !== '.' ? '.' + this.defaultEngine : this.defaultEngine;\n    fileName += this.ext;\n  }\n\n  if (!opts.engines[this.ext]) {\n    // load engine\n    var mod = this.ext.substr(1);\n    debug('require \"%s\"', mod); // default engine export\n\n    var fn = require(mod).__express;\n\n    if (typeof fn !== 'function') {\n      throw new Error('Module \"' + mod + '\" does not provide a view engine.');\n    }\n\n    opts.engines[this.ext] = fn;\n  } // store loaded engine\n\n\n  this.engine = opts.engines[this.ext]; // lookup path\n\n  this.path = this.lookup(fileName);\n}\n/**\n * Lookup view by the given `name`\n *\n * @param {string} name\n * @private\n */\n\n\nView.prototype.lookup = function lookup(name) {\n  var path;\n  var roots = [].concat(this.root);\n  debug('lookup \"%s\"', name);\n\n  for (var i = 0; i < roots.length && !path; i++) {\n    var root = roots[i]; // resolve the path\n\n    var loc = resolve(root, name);\n    var dir = dirname(loc);\n    var file = basename(loc); // resolve the file\n\n    path = this.resolve(dir, file);\n  }\n\n  return path;\n};\n/**\n * Render with the given options.\n *\n * @param {object} options\n * @param {function} callback\n * @private\n */\n\n\nView.prototype.render = function render(options, callback) {\n  debug('render \"%s\"', this.path);\n  this.engine(this.path, options, callback);\n};\n/**\n * Resolve the file within the given directory.\n *\n * @param {string} dir\n * @param {string} file\n * @private\n */\n\n\nView.prototype.resolve = function resolve(dir, file) {\n  var ext = this.ext; // <path>.<ext>\n\n  var path = join(dir, file);\n  var stat = tryStat(path);\n\n  if (stat && stat.isFile()) {\n    return path;\n  } // <path>/index.<ext>\n\n\n  path = join(dir, basename(file, ext), 'index' + ext);\n  stat = tryStat(path);\n\n  if (stat && stat.isFile()) {\n    return path;\n  }\n};\n/**\n * Return a stat, maybe.\n *\n * @param {string} path\n * @return {fs.Stats}\n * @private\n */\n\n\nfunction tryStat(path) {\n  debug('stat \"%s\"', path);\n\n  try {\n    return fs.statSync(path);\n  } catch (e) {\n    return undefined;\n  }\n}","map":{"version":3,"sources":["/Users/dhruv/Sneaks/sneaks-website/node_modules/express/lib/view.js"],"names":["debug","require","path","fs","dirname","basename","extname","join","resolve","module","exports","View","name","options","opts","defaultEngine","ext","root","Error","fileName","engines","mod","substr","fn","__express","engine","lookup","prototype","roots","concat","i","length","loc","dir","file","render","callback","stat","tryStat","isFile","statSync","e","undefined"],"mappings":"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","sourcesContent":["/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar debug = require('debug')('express:view');\nvar path = require('path');\nvar fs = require('fs');\n\n/**\n * Module variables.\n * @private\n */\n\nvar dirname = path.dirname;\nvar basename = path.basename;\nvar extname = path.extname;\nvar join = path.join;\nvar resolve = path.resolve;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = View;\n\n/**\n * Initialize a new `View` with the given `name`.\n *\n * Options:\n *\n *   - `defaultEngine` the default template engine name\n *   - `engines` template engine require() cache\n *   - `root` root path for view lookup\n *\n * @param {string} name\n * @param {object} options\n * @public\n */\n\nfunction View(name, options) {\n  var opts = options || {};\n\n  this.defaultEngine = opts.defaultEngine;\n  this.ext = extname(name);\n  this.name = name;\n  this.root = opts.root;\n\n  if (!this.ext && !this.defaultEngine) {\n    throw new Error('No default engine was specified and no extension was provided.');\n  }\n\n  var fileName = name;\n\n  if (!this.ext) {\n    // get extension from default engine name\n    this.ext = this.defaultEngine[0] !== '.'\n      ? '.' + this.defaultEngine\n      : this.defaultEngine;\n\n    fileName += this.ext;\n  }\n\n  if (!opts.engines[this.ext]) {\n    // load engine\n    var mod = this.ext.substr(1)\n    debug('require \"%s\"', mod)\n\n    // default engine export\n    var fn = require(mod).__express\n\n    if (typeof fn !== 'function') {\n      throw new Error('Module \"' + mod + '\" does not provide a view engine.')\n    }\n\n    opts.engines[this.ext] = fn\n  }\n\n  // store loaded engine\n  this.engine = opts.engines[this.ext];\n\n  // lookup path\n  this.path = this.lookup(fileName);\n}\n\n/**\n * Lookup view by the given `name`\n *\n * @param {string} name\n * @private\n */\n\nView.prototype.lookup = function lookup(name) {\n  var path;\n  var roots = [].concat(this.root);\n\n  debug('lookup \"%s\"', name);\n\n  for (var i = 0; i < roots.length && !path; i++) {\n    var root = roots[i];\n\n    // resolve the path\n    var loc = resolve(root, name);\n    var dir = dirname(loc);\n    var file = basename(loc);\n\n    // resolve the file\n    path = this.resolve(dir, file);\n  }\n\n  return path;\n};\n\n/**\n * Render with the given options.\n *\n * @param {object} options\n * @param {function} callback\n * @private\n */\n\nView.prototype.render = function render(options, callback) {\n  debug('render \"%s\"', this.path);\n  this.engine(this.path, options, callback);\n};\n\n/**\n * Resolve the file within the given directory.\n *\n * @param {string} dir\n * @param {string} file\n * @private\n */\n\nView.prototype.resolve = function resolve(dir, file) {\n  var ext = this.ext;\n\n  // <path>.<ext>\n  var path = join(dir, file);\n  var stat = tryStat(path);\n\n  if (stat && stat.isFile()) {\n    return path;\n  }\n\n  // <path>/index.<ext>\n  path = join(dir, basename(file, ext), 'index' + ext);\n  stat = tryStat(path);\n\n  if (stat && stat.isFile()) {\n    return path;\n  }\n};\n\n/**\n * Return a stat, maybe.\n *\n * @param {string} path\n * @return {fs.Stats}\n * @private\n */\n\nfunction tryStat(path) {\n  debug('stat \"%s\"', path);\n\n  try {\n    return fs.statSync(path);\n  } catch (e) {\n    return undefined;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}