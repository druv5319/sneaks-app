{"ast":null,"code":"var select = require('css-select'),\n    utils = require('../utils'),\n    domEach = utils.domEach,\n    uniqueSort = require('htmlparser2').DomUtils.uniqueSort,\n    isTag = utils.isTag,\n    _ = {\n  bind: require('lodash/bind'),\n  forEach: require('lodash/forEach'),\n  reject: require('lodash/reject'),\n  filter: require('lodash/filter'),\n  reduce: require('lodash/reduce')\n};\n\nexports.find = function (selectorOrHaystack) {\n  var elems = _.reduce(this, function (memo, elem) {\n    return memo.concat(_.filter(elem.children, isTag));\n  }, []);\n\n  var contains = this.constructor.contains;\n  var haystack;\n\n  if (selectorOrHaystack && typeof selectorOrHaystack !== 'string') {\n    if (selectorOrHaystack.cheerio) {\n      haystack = selectorOrHaystack.get();\n    } else {\n      haystack = [selectorOrHaystack];\n    }\n\n    return this._make(haystack.filter(function (elem) {\n      var idx, len;\n\n      for (idx = 0, len = this.length; idx < len; ++idx) {\n        if (contains(this[idx], elem)) {\n          return true;\n        }\n      }\n    }, this));\n  }\n\n  var options = {\n    __proto__: this.options,\n    context: this.toArray()\n  };\n  return this._make(select(selectorOrHaystack, elems, options));\n}; // Get the parent of each element in the current set of matched elements,\n// optionally filtered by a selector.\n\n\nexports.parent = function (selector) {\n  var set = [];\n  domEach(this, function (idx, elem) {\n    var parentElem = elem.parent;\n\n    if (parentElem && set.indexOf(parentElem) < 0) {\n      set.push(parentElem);\n    }\n  });\n\n  if (arguments.length) {\n    set = exports.filter.call(set, selector, this);\n  }\n\n  return this._make(set);\n};\n\nexports.parents = function (selector) {\n  var parentNodes = []; // When multiple DOM elements are in the original set, the resulting set will\n  // be in *reverse* order of the original elements as well, with duplicates\n  // removed.\n\n  this.get().reverse().forEach(function (elem) {\n    traverseParents(this, elem.parent, selector, Infinity).forEach(function (node) {\n      if (parentNodes.indexOf(node) === -1) {\n        parentNodes.push(node);\n      }\n    });\n  }, this);\n  return this._make(parentNodes);\n};\n\nexports.parentsUntil = function (selector, filter) {\n  var parentNodes = [],\n      untilNode,\n      untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.parents().toArray(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.toArray();\n  } else if (selector) {\n    untilNode = selector;\n  } // When multiple DOM elements are in the original set, the resulting set will\n  // be in *reverse* order of the original elements as well, with duplicates\n  // removed.\n\n\n  this.toArray().reverse().forEach(function (elem) {\n    while (elem = elem.parent) {\n      if (untilNode && elem !== untilNode || untilNodes && untilNodes.indexOf(elem) === -1 || !untilNode && !untilNodes) {\n        if (isTag(elem) && parentNodes.indexOf(elem) === -1) {\n          parentNodes.push(elem);\n        }\n      } else {\n        break;\n      }\n    }\n  }, this);\n  return this._make(filter ? select(filter, parentNodes, this.options) : parentNodes);\n}; // For each element in the set, get the first element that matches the selector\n// by testing the element itself and traversing up through its ancestors in the\n// DOM tree.\n\n\nexports.closest = function (selector) {\n  var set = [];\n\n  if (!selector) {\n    return this._make(set);\n  }\n\n  domEach(this, function (idx, elem) {\n    var closestElem = traverseParents(this, elem, selector, 1)[0]; // Do not add duplicate elements to the set\n\n    if (closestElem && set.indexOf(closestElem) < 0) {\n      set.push(closestElem);\n    }\n  }.bind(this));\n  return this._make(set);\n};\n\nexports.next = function (selector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [];\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.next) {\n      if (isTag(elem)) {\n        elems.push(elem);\n        return;\n      }\n    }\n  });\n\n  return selector ? exports.filter.call(elems, selector, this) : this._make(elems);\n};\n\nexports.nextAll = function (selector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [];\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.next) {\n      if (isTag(elem) && elems.indexOf(elem) === -1) {\n        elems.push(elem);\n      }\n    }\n  });\n\n  return selector ? exports.filter.call(elems, selector, this) : this._make(elems);\n};\n\nexports.nextUntil = function (selector, filterSelector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [],\n      untilNode,\n      untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.nextAll().get(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.get();\n  } else if (selector) {\n    untilNode = selector;\n  }\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.next) {\n      if (untilNode && elem !== untilNode || untilNodes && untilNodes.indexOf(elem) === -1 || !untilNode && !untilNodes) {\n        if (isTag(elem) && elems.indexOf(elem) === -1) {\n          elems.push(elem);\n        }\n      } else {\n        break;\n      }\n    }\n  });\n\n  return filterSelector ? exports.filter.call(elems, filterSelector, this) : this._make(elems);\n};\n\nexports.prev = function (selector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [];\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.prev) {\n      if (isTag(elem)) {\n        elems.push(elem);\n        return;\n      }\n    }\n  });\n\n  return selector ? exports.filter.call(elems, selector, this) : this._make(elems);\n};\n\nexports.prevAll = function (selector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [];\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.prev) {\n      if (isTag(elem) && elems.indexOf(elem) === -1) {\n        elems.push(elem);\n      }\n    }\n  });\n\n  return selector ? exports.filter.call(elems, selector, this) : this._make(elems);\n};\n\nexports.prevUntil = function (selector, filterSelector) {\n  if (!this[0]) {\n    return this;\n  }\n\n  var elems = [],\n      untilNode,\n      untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.prevAll().get(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.get();\n  } else if (selector) {\n    untilNode = selector;\n  }\n\n  _.forEach(this, function (elem) {\n    while (elem = elem.prev) {\n      if (untilNode && elem !== untilNode || untilNodes && untilNodes.indexOf(elem) === -1 || !untilNode && !untilNodes) {\n        if (isTag(elem) && elems.indexOf(elem) === -1) {\n          elems.push(elem);\n        }\n      } else {\n        break;\n      }\n    }\n  });\n\n  return filterSelector ? exports.filter.call(elems, filterSelector, this) : this._make(elems);\n};\n\nexports.siblings = function (selector) {\n  var parent = this.parent();\n\n  var elems = _.filter(parent ? parent.children() : this.siblingsAndMe(), _.bind(function (elem) {\n    return isTag(elem) && !this.is(elem);\n  }, this));\n\n  if (selector !== undefined) {\n    return exports.filter.call(elems, selector, this);\n  } else {\n    return this._make(elems);\n  }\n};\n\nexports.children = function (selector) {\n  var elems = _.reduce(this, function (memo, elem) {\n    return memo.concat(_.filter(elem.children, isTag));\n  }, []);\n\n  if (selector === undefined) return this._make(elems);\n  return exports.filter.call(elems, selector, this);\n};\n\nexports.contents = function () {\n  return this._make(_.reduce(this, function (all, elem) {\n    all.push.apply(all, elem.children);\n    return all;\n  }, []));\n};\n\nexports.each = function (fn) {\n  var i = 0,\n      len = this.length;\n\n  while (i < len && fn.call(this[i], i, this[i]) !== false) ++i;\n\n  return this;\n};\n\nexports.map = function (fn) {\n  return this._make(_.reduce(this, function (memo, el, i) {\n    var val = fn.call(el, i, el);\n    return val == null ? memo : memo.concat(val);\n  }, []));\n};\n\nvar makeFilterMethod = function (filterFn) {\n  return function (match, container) {\n    var testFn;\n    container = container || this;\n\n    if (typeof match === 'string') {\n      testFn = select.compile(match, container.options);\n    } else if (typeof match === 'function') {\n      testFn = function (el, i) {\n        return match.call(el, i, el);\n      };\n    } else if (match.cheerio) {\n      testFn = match.is.bind(match);\n    } else {\n      testFn = function (el) {\n        return match === el;\n      };\n    }\n\n    return container._make(filterFn(this, testFn));\n  };\n};\n\nexports.filter = makeFilterMethod(_.filter);\nexports.not = makeFilterMethod(_.reject);\n\nexports.has = function (selectorOrHaystack) {\n  var that = this;\n  return exports.filter.call(this, function () {\n    return that._make(this).find(selectorOrHaystack).length > 0;\n  });\n};\n\nexports.first = function () {\n  return this.length > 1 ? this._make(this[0]) : this;\n};\n\nexports.last = function () {\n  return this.length > 1 ? this._make(this[this.length - 1]) : this;\n}; // Reduce the set of matched elements to the one at the specified index.\n\n\nexports.eq = function (i) {\n  i = +i; // Use the first identity optimization if possible\n\n  if (i === 0 && this.length <= 1) return this;\n  if (i < 0) i = this.length + i;\n  return this[i] ? this._make(this[i]) : this._make([]);\n}; // Retrieve the DOM elements matched by the jQuery object.\n\n\nexports.get = function (i) {\n  if (i == null) {\n    return Array.prototype.slice.call(this);\n  } else {\n    return this[i < 0 ? this.length + i : i];\n  }\n}; // Search for a given element from among the matched elements.\n\n\nexports.index = function (selectorOrNeedle) {\n  var $haystack, needle;\n\n  if (arguments.length === 0) {\n    $haystack = this.parent().children();\n    needle = this[0];\n  } else if (typeof selectorOrNeedle === 'string') {\n    $haystack = this._make(selectorOrNeedle);\n    needle = this[0];\n  } else {\n    $haystack = this;\n    needle = selectorOrNeedle.cheerio ? selectorOrNeedle[0] : selectorOrNeedle;\n  }\n\n  return $haystack.get().indexOf(needle);\n};\n\nexports.slice = function () {\n  return this._make([].slice.apply(this, arguments));\n};\n\nfunction traverseParents(self, elem, selector, limit) {\n  var elems = [];\n\n  while (elem && elems.length < limit) {\n    if (!selector || exports.filter.call([elem], selector, self).length) {\n      elems.push(elem);\n    }\n\n    elem = elem.parent;\n  }\n\n  return elems;\n} // End the most recent filtering operation in the current chain and return the\n// set of matched elements to its previous state.\n\n\nexports.end = function () {\n  return this.prevObject || this._make([]);\n};\n\nexports.add = function (other, context) {\n  var selection = this._make(other, context);\n\n  var contents = uniqueSort(selection.get().concat(this.get()));\n\n  for (var i = 0; i < contents.length; ++i) {\n    selection[i] = contents[i];\n  }\n\n  selection.length = contents.length;\n  return selection;\n}; // Add the previous set of elements on the stack to the current set, optionally\n// filtered by a selector.\n\n\nexports.addBack = function (selector) {\n  return this.add(arguments.length ? this.prevObject.filter(selector) : this.prevObject);\n};","map":{"version":3,"sources":["/Users/dhruv/Sneaks/sneaks-website/node_modules/cheerio/lib/api/traversing.js"],"names":["select","require","utils","domEach","uniqueSort","DomUtils","isTag","_","bind","forEach","reject","filter","reduce","exports","find","selectorOrHaystack","elems","memo","elem","concat","children","contains","constructor","haystack","cheerio","get","_make","idx","len","length","options","__proto__","context","toArray","parent","selector","set","parentElem","indexOf","push","arguments","call","parents","parentNodes","reverse","traverseParents","Infinity","node","parentsUntil","untilNode","untilNodes","closest","closestElem","next","nextAll","nextUntil","filterSelector","prev","prevAll","prevUntil","siblings","siblingsAndMe","is","undefined","contents","all","apply","each","fn","i","map","el","val","makeFilterMethod","filterFn","match","container","testFn","compile","not","has","that","first","last","eq","Array","prototype","slice","index","selectorOrNeedle","$haystack","needle","self","limit","end","prevObject","add","other","selection","addBack"],"mappings":"AAAA,IAAIA,MAAM,GAAGC,OAAO,CAAC,YAAD,CAApB;AAAA,IACIC,KAAK,GAAGD,OAAO,CAAC,UAAD,CADnB;AAAA,IAEIE,OAAO,GAAGD,KAAK,CAACC,OAFpB;AAAA,IAGIC,UAAU,GAAGH,OAAO,CAAC,aAAD,CAAP,CAAuBI,QAAvB,CAAgCD,UAHjD;AAAA,IAIIE,KAAK,GAAGJ,KAAK,CAACI,KAJlB;AAAA,IAKIC,CAAC,GAAG;AACFC,EAAAA,IAAI,EAAEP,OAAO,CAAC,aAAD,CADX;AAEFQ,EAAAA,OAAO,EAAER,OAAO,CAAC,gBAAD,CAFd;AAGFS,EAAAA,MAAM,EAAET,OAAO,CAAC,eAAD,CAHb;AAIFU,EAAAA,MAAM,EAAEV,OAAO,CAAC,eAAD,CAJb;AAKFW,EAAAA,MAAM,EAAEX,OAAO,CAAC,eAAD;AALb,CALR;;AAaAY,OAAO,CAACC,IAAR,GAAe,UAASC,kBAAT,EAA6B;AAC1C,MAAIC,KAAK,GAAGT,CAAC,CAACK,MAAF,CAAS,IAAT,EAAe,UAASK,IAAT,EAAeC,IAAf,EAAqB;AAC9C,WAAOD,IAAI,CAACE,MAAL,CAAYZ,CAAC,CAACI,MAAF,CAASO,IAAI,CAACE,QAAd,EAAwBd,KAAxB,CAAZ,CAAP;AACD,GAFW,EAET,EAFS,CAAZ;;AAGA,MAAIe,QAAQ,GAAG,KAAKC,WAAL,CAAiBD,QAAhC;AACA,MAAIE,QAAJ;;AAEA,MAAIR,kBAAkB,IAAI,OAAOA,kBAAP,KAA8B,QAAxD,EAAkE;AAChE,QAAIA,kBAAkB,CAACS,OAAvB,EAAgC;AAC9BD,MAAAA,QAAQ,GAAGR,kBAAkB,CAACU,GAAnB,EAAX;AACD,KAFD,MAEO;AACLF,MAAAA,QAAQ,GAAG,CAACR,kBAAD,CAAX;AACD;;AAED,WAAO,KAAKW,KAAL,CAAWH,QAAQ,CAACZ,MAAT,CAAgB,UAASO,IAAT,EAAe;AAC/C,UAAIS,GAAJ,EAASC,GAAT;;AACA,WAAKD,GAAG,GAAG,CAAN,EAASC,GAAG,GAAG,KAAKC,MAAzB,EAAiCF,GAAG,GAAGC,GAAvC,EAA4C,EAAED,GAA9C,EAAmD;AACjD,YAAIN,QAAQ,CAAC,KAAKM,GAAL,CAAD,EAAYT,IAAZ,CAAZ,EAA+B;AAC7B,iBAAO,IAAP;AACD;AACF;AACF,KAPiB,EAOf,IAPe,CAAX,CAAP;AAQD;;AAED,MAAIY,OAAO,GAAG;AAACC,IAAAA,SAAS,EAAE,KAAKD,OAAjB;AAA0BE,IAAAA,OAAO,EAAE,KAAKC,OAAL;AAAnC,GAAd;AAEA,SAAO,KAAKP,KAAL,CAAW1B,MAAM,CAACe,kBAAD,EAAqBC,KAArB,EAA4Bc,OAA5B,CAAjB,CAAP;AACD,CA3BD,C,CA6BA;AACA;;;AACAjB,OAAO,CAACqB,MAAR,GAAiB,UAASC,QAAT,EAAmB;AAClC,MAAIC,GAAG,GAAG,EAAV;AAEAjC,EAAAA,OAAO,CAAC,IAAD,EAAO,UAASwB,GAAT,EAAcT,IAAd,EAAoB;AAChC,QAAImB,UAAU,GAAGnB,IAAI,CAACgB,MAAtB;;AACA,QAAIG,UAAU,IAAID,GAAG,CAACE,OAAJ,CAAYD,UAAZ,IAA0B,CAA5C,EAA+C;AAC7CD,MAAAA,GAAG,CAACG,IAAJ,CAASF,UAAT;AACD;AACF,GALM,CAAP;;AAOA,MAAIG,SAAS,CAACX,MAAd,EAAsB;AACpBO,IAAAA,GAAG,GAAGvB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBL,GAApB,EAAyBD,QAAzB,EAAmC,IAAnC,CAAN;AACD;;AAED,SAAO,KAAKT,KAAL,CAAWU,GAAX,CAAP;AACD,CAfD;;AAiBAvB,OAAO,CAAC6B,OAAR,GAAkB,UAASP,QAAT,EAAmB;AACnC,MAAIQ,WAAW,GAAG,EAAlB,CADmC,CAGnC;AACA;AACA;;AACA,OAAKlB,GAAL,GAAWmB,OAAX,GAAqBnC,OAArB,CAA6B,UAASS,IAAT,EAAe;AAC1C2B,IAAAA,eAAe,CAAC,IAAD,EAAO3B,IAAI,CAACgB,MAAZ,EAAoBC,QAApB,EAA8BW,QAA9B,CAAf,CACGrC,OADH,CACW,UAASsC,IAAT,EAAe;AACtB,UAAIJ,WAAW,CAACL,OAAZ,CAAoBS,IAApB,MAA8B,CAAC,CAAnC,EAAsC;AACpCJ,QAAAA,WAAW,CAACJ,IAAZ,CAAiBQ,IAAjB;AACD;AACF,KALH;AAOD,GARD,EAQG,IARH;AAUA,SAAO,KAAKrB,KAAL,CAAWiB,WAAX,CAAP;AACD,CAjBD;;AAmBA9B,OAAO,CAACmC,YAAR,GAAuB,UAASb,QAAT,EAAmBxB,MAAnB,EAA2B;AAChD,MAAIgC,WAAW,GAAG,EAAlB;AAAA,MAAsBM,SAAtB;AAAA,MAAiCC,UAAjC;;AAEA,MAAI,OAAOf,QAAP,KAAoB,QAAxB,EAAkC;AAChCc,IAAAA,SAAS,GAAGjD,MAAM,CAACmC,QAAD,EAAW,KAAKO,OAAL,GAAeT,OAAf,EAAX,EAAqC,KAAKH,OAA1C,CAAN,CAAyD,CAAzD,CAAZ;AACD,GAFD,MAEO,IAAIK,QAAQ,IAAIA,QAAQ,CAACX,OAAzB,EAAkC;AACvC0B,IAAAA,UAAU,GAAGf,QAAQ,CAACF,OAAT,EAAb;AACD,GAFM,MAEA,IAAIE,QAAJ,EAAc;AACnBc,IAAAA,SAAS,GAAGd,QAAZ;AACD,GAT+C,CAWhD;AACA;AACA;;;AAEA,OAAKF,OAAL,GAAeW,OAAf,GAAyBnC,OAAzB,CAAiC,UAASS,IAAT,EAAe;AAC9C,WAAQA,IAAI,GAAGA,IAAI,CAACgB,MAApB,EAA6B;AAC3B,UAAKe,SAAS,IAAI/B,IAAI,KAAK+B,SAAvB,IACDC,UAAU,IAAIA,UAAU,CAACZ,OAAX,CAAmBpB,IAAnB,MAA6B,CAAC,CAD3C,IAED,CAAC+B,SAAD,IAAc,CAACC,UAFlB,EAE+B;AAC7B,YAAI5C,KAAK,CAACY,IAAD,CAAL,IAAeyB,WAAW,CAACL,OAAZ,CAAoBpB,IAApB,MAA8B,CAAC,CAAlD,EAAqD;AAAEyB,UAAAA,WAAW,CAACJ,IAAZ,CAAiBrB,IAAjB;AAAyB;AACjF,OAJD,MAIO;AACL;AACD;AACF;AACF,GAVD,EAUG,IAVH;AAYA,SAAO,KAAKQ,KAAL,CAAWf,MAAM,GAAGX,MAAM,CAACW,MAAD,EAASgC,WAAT,EAAsB,KAAKb,OAA3B,CAAT,GAA+Ca,WAAhE,CAAP;AACD,CA5BD,C,CA8BA;AACA;AACA;;;AACA9B,OAAO,CAACsC,OAAR,GAAkB,UAAShB,QAAT,EAAmB;AACnC,MAAIC,GAAG,GAAG,EAAV;;AAEA,MAAI,CAACD,QAAL,EAAe;AACb,WAAO,KAAKT,KAAL,CAAWU,GAAX,CAAP;AACD;;AAEDjC,EAAAA,OAAO,CAAC,IAAD,EAAO,UAASwB,GAAT,EAAcT,IAAd,EAAoB;AAChC,QAAIkC,WAAW,GAAGP,eAAe,CAAC,IAAD,EAAO3B,IAAP,EAAaiB,QAAb,EAAuB,CAAvB,CAAf,CAAyC,CAAzC,CAAlB,CADgC,CAGhC;;AACA,QAAIiB,WAAW,IAAIhB,GAAG,CAACE,OAAJ,CAAYc,WAAZ,IAA2B,CAA9C,EAAiD;AAC/ChB,MAAAA,GAAG,CAACG,IAAJ,CAASa,WAAT;AACD;AACF,GAPa,CAOZ5C,IAPY,CAOP,IAPO,CAAP,CAAP;AASA,SAAO,KAAKkB,KAAL,CAAWU,GAAX,CAAP;AACD,CAjBD;;AAmBAvB,OAAO,CAACwC,IAAR,GAAe,UAASlB,QAAT,EAAmB;AAChC,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAInB,KAAK,GAAG,EAAZ;;AAEAT,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACmC,IAApB,EAA2B;AACzB,UAAI/C,KAAK,CAACY,IAAD,CAAT,EAAiB;AACfF,QAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACA;AACD;AACF;AACF,GAPD;;AASA,SAAOiB,QAAQ,GACbtB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CADa,GAEb,KAAKT,KAAL,CAAWV,KAAX,CAFF;AAGD,CAhBD;;AAkBAH,OAAO,CAACyC,OAAR,GAAkB,UAASnB,QAAT,EAAmB;AACnC,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAInB,KAAK,GAAG,EAAZ;;AAEAT,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACmC,IAApB,EAA2B;AACzB,UAAI/C,KAAK,CAACY,IAAD,CAAL,IAAeF,KAAK,CAACsB,OAAN,CAAcpB,IAAd,MAAwB,CAAC,CAA5C,EAA+C;AAC7CF,QAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACD;AACF;AACF,GAND;;AAQA,SAAOiB,QAAQ,GACbtB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CADa,GAEb,KAAKT,KAAL,CAAWV,KAAX,CAFF;AAGD,CAfD;;AAiBAH,OAAO,CAAC0C,SAAR,GAAoB,UAASpB,QAAT,EAAmBqB,cAAnB,EAAmC;AACrD,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAIxC,KAAK,GAAG,EAAZ;AAAA,MAAgBiC,SAAhB;AAAA,MAA2BC,UAA3B;;AAEA,MAAI,OAAOf,QAAP,KAAoB,QAAxB,EAAkC;AAChCc,IAAAA,SAAS,GAAGjD,MAAM,CAACmC,QAAD,EAAW,KAAKmB,OAAL,GAAe7B,GAAf,EAAX,EAAiC,KAAKK,OAAtC,CAAN,CAAqD,CAArD,CAAZ;AACD,GAFD,MAEO,IAAIK,QAAQ,IAAIA,QAAQ,CAACX,OAAzB,EAAkC;AACvC0B,IAAAA,UAAU,GAAGf,QAAQ,CAACV,GAAT,EAAb;AACD,GAFM,MAEA,IAAIU,QAAJ,EAAc;AACnBc,IAAAA,SAAS,GAAGd,QAAZ;AACD;;AAED5B,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACmC,IAApB,EAA2B;AACzB,UAAKJ,SAAS,IAAI/B,IAAI,KAAK+B,SAAvB,IACDC,UAAU,IAAIA,UAAU,CAACZ,OAAX,CAAmBpB,IAAnB,MAA6B,CAAC,CAD3C,IAED,CAAC+B,SAAD,IAAc,CAACC,UAFlB,EAE+B;AAC7B,YAAI5C,KAAK,CAACY,IAAD,CAAL,IAAeF,KAAK,CAACsB,OAAN,CAAcpB,IAAd,MAAwB,CAAC,CAA5C,EAA+C;AAC7CF,UAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACD;AACF,OAND,MAMO;AACL;AACD;AACF;AACF,GAZD;;AAcA,SAAOsC,cAAc,GACnB3C,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BwC,cAA3B,EAA2C,IAA3C,CADmB,GAEnB,KAAK9B,KAAL,CAAWV,KAAX,CAFF;AAGD,CA7BD;;AA+BAH,OAAO,CAAC4C,IAAR,GAAe,UAAStB,QAAT,EAAmB;AAChC,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAInB,KAAK,GAAG,EAAZ;;AAEAT,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACuC,IAApB,EAA2B;AACzB,UAAInD,KAAK,CAACY,IAAD,CAAT,EAAiB;AACfF,QAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACA;AACD;AACF;AACF,GAPD;;AASA,SAAOiB,QAAQ,GACbtB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CADa,GAEb,KAAKT,KAAL,CAAWV,KAAX,CAFF;AAGD,CAhBD;;AAkBAH,OAAO,CAAC6C,OAAR,GAAkB,UAASvB,QAAT,EAAmB;AACnC,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAInB,KAAK,GAAG,EAAZ;;AAEAT,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACuC,IAApB,EAA2B;AACzB,UAAInD,KAAK,CAACY,IAAD,CAAL,IAAeF,KAAK,CAACsB,OAAN,CAAcpB,IAAd,MAAwB,CAAC,CAA5C,EAA+C;AAC7CF,QAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACD;AACF;AACF,GAND;;AAQA,SAAOiB,QAAQ,GACbtB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CADa,GAEb,KAAKT,KAAL,CAAWV,KAAX,CAFF;AAGD,CAfD;;AAiBAH,OAAO,CAAC8C,SAAR,GAAoB,UAASxB,QAAT,EAAmBqB,cAAnB,EAAmC;AACrD,MAAI,CAAC,KAAK,CAAL,CAAL,EAAc;AAAE,WAAO,IAAP;AAAc;;AAC9B,MAAIxC,KAAK,GAAG,EAAZ;AAAA,MAAgBiC,SAAhB;AAAA,MAA2BC,UAA3B;;AAEA,MAAI,OAAOf,QAAP,KAAoB,QAAxB,EAAkC;AAChCc,IAAAA,SAAS,GAAGjD,MAAM,CAACmC,QAAD,EAAW,KAAKuB,OAAL,GAAejC,GAAf,EAAX,EAAiC,KAAKK,OAAtC,CAAN,CAAqD,CAArD,CAAZ;AACD,GAFD,MAEO,IAAIK,QAAQ,IAAIA,QAAQ,CAACX,OAAzB,EAAkC;AACvC0B,IAAAA,UAAU,GAAGf,QAAQ,CAACV,GAAT,EAAb;AACD,GAFM,MAEA,IAAIU,QAAJ,EAAc;AACnBc,IAAAA,SAAS,GAAGd,QAAZ;AACD;;AAED5B,EAAAA,CAAC,CAACE,OAAF,CAAU,IAAV,EAAgB,UAASS,IAAT,EAAe;AAC7B,WAAQA,IAAI,GAAGA,IAAI,CAACuC,IAApB,EAA2B;AACzB,UAAKR,SAAS,IAAI/B,IAAI,KAAK+B,SAAvB,IACDC,UAAU,IAAIA,UAAU,CAACZ,OAAX,CAAmBpB,IAAnB,MAA6B,CAAC,CAD3C,IAED,CAAC+B,SAAD,IAAc,CAACC,UAFlB,EAE+B;AAC7B,YAAI5C,KAAK,CAACY,IAAD,CAAL,IAAeF,KAAK,CAACsB,OAAN,CAAcpB,IAAd,MAAwB,CAAC,CAA5C,EAA+C;AAC7CF,UAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACD;AACF,OAND,MAMO;AACL;AACD;AACF;AACF,GAZD;;AAcA,SAAOsC,cAAc,GACnB3C,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BwC,cAA3B,EAA2C,IAA3C,CADmB,GAEnB,KAAK9B,KAAL,CAAWV,KAAX,CAFF;AAGD,CA7BD;;AA+BAH,OAAO,CAAC+C,QAAR,GAAmB,UAASzB,QAAT,EAAmB;AACpC,MAAID,MAAM,GAAG,KAAKA,MAAL,EAAb;;AAEA,MAAIlB,KAAK,GAAGT,CAAC,CAACI,MAAF,CACVuB,MAAM,GAAGA,MAAM,CAACd,QAAP,EAAH,GAAuB,KAAKyC,aAAL,EADnB,EAEVtD,CAAC,CAACC,IAAF,CAAO,UAASU,IAAT,EAAe;AAAE,WAAOZ,KAAK,CAACY,IAAD,CAAL,IAAe,CAAC,KAAK4C,EAAL,CAAQ5C,IAAR,CAAvB;AAAuC,GAA/D,EAAiE,IAAjE,CAFU,CAAZ;;AAKA,MAAIiB,QAAQ,KAAK4B,SAAjB,EAA4B;AAC1B,WAAOlD,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAKT,KAAL,CAAWV,KAAX,CAAP;AACD;AACF,CAbD;;AAeAH,OAAO,CAACO,QAAR,GAAmB,UAASe,QAAT,EAAmB;AAEpC,MAAInB,KAAK,GAAGT,CAAC,CAACK,MAAF,CAAS,IAAT,EAAe,UAASK,IAAT,EAAeC,IAAf,EAAqB;AAC9C,WAAOD,IAAI,CAACE,MAAL,CAAYZ,CAAC,CAACI,MAAF,CAASO,IAAI,CAACE,QAAd,EAAwBd,KAAxB,CAAZ,CAAP;AACD,GAFW,EAET,EAFS,CAAZ;;AAIA,MAAI6B,QAAQ,KAAK4B,SAAjB,EAA4B,OAAO,KAAKrC,KAAL,CAAWV,KAAX,CAAP;AAE5B,SAAOH,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoBzB,KAApB,EAA2BmB,QAA3B,EAAqC,IAArC,CAAP;AACD,CATD;;AAWAtB,OAAO,CAACmD,QAAR,GAAmB,YAAW;AAC5B,SAAO,KAAKtC,KAAL,CAAWnB,CAAC,CAACK,MAAF,CAAS,IAAT,EAAe,UAASqD,GAAT,EAAc/C,IAAd,EAAoB;AACnD+C,IAAAA,GAAG,CAAC1B,IAAJ,CAAS2B,KAAT,CAAeD,GAAf,EAAoB/C,IAAI,CAACE,QAAzB;AACA,WAAO6C,GAAP;AACD,GAHiB,EAGf,EAHe,CAAX,CAAP;AAID,CALD;;AAOApD,OAAO,CAACsD,IAAR,GAAe,UAASC,EAAT,EAAa;AAC1B,MAAIC,CAAC,GAAG,CAAR;AAAA,MAAWzC,GAAG,GAAG,KAAKC,MAAtB;;AACA,SAAOwC,CAAC,GAAGzC,GAAJ,IAAWwC,EAAE,CAAC3B,IAAH,CAAQ,KAAK4B,CAAL,CAAR,EAAiBA,CAAjB,EAAoB,KAAKA,CAAL,CAApB,MAAiC,KAAnD,EAA0D,EAAEA,CAAF;;AAC1D,SAAO,IAAP;AACD,CAJD;;AAMAxD,OAAO,CAACyD,GAAR,GAAc,UAASF,EAAT,EAAa;AACzB,SAAO,KAAK1C,KAAL,CAAWnB,CAAC,CAACK,MAAF,CAAS,IAAT,EAAe,UAASK,IAAT,EAAesD,EAAf,EAAmBF,CAAnB,EAAsB;AACrD,QAAIG,GAAG,GAAGJ,EAAE,CAAC3B,IAAH,CAAQ8B,EAAR,EAAYF,CAAZ,EAAeE,EAAf,CAAV;AACA,WAAOC,GAAG,IAAI,IAAP,GAAcvD,IAAd,GAAqBA,IAAI,CAACE,MAAL,CAAYqD,GAAZ,CAA5B;AACD,GAHiB,EAGf,EAHe,CAAX,CAAP;AAID,CALD;;AAOA,IAAIC,gBAAgB,GAAG,UAASC,QAAT,EAAmB;AACxC,SAAO,UAASC,KAAT,EAAgBC,SAAhB,EAA2B;AAChC,QAAIC,MAAJ;AACAD,IAAAA,SAAS,GAAGA,SAAS,IAAI,IAAzB;;AAEA,QAAI,OAAOD,KAAP,KAAiB,QAArB,EAA+B;AAC7BE,MAAAA,MAAM,GAAG7E,MAAM,CAAC8E,OAAP,CAAeH,KAAf,EAAsBC,SAAS,CAAC9C,OAAhC,CAAT;AACD,KAFD,MAEO,IAAI,OAAO6C,KAAP,KAAiB,UAArB,EAAiC;AACtCE,MAAAA,MAAM,GAAG,UAASN,EAAT,EAAaF,CAAb,EAAgB;AACvB,eAAOM,KAAK,CAAClC,IAAN,CAAW8B,EAAX,EAAeF,CAAf,EAAkBE,EAAlB,CAAP;AACD,OAFD;AAGD,KAJM,MAIA,IAAII,KAAK,CAACnD,OAAV,EAAmB;AACxBqD,MAAAA,MAAM,GAAGF,KAAK,CAACb,EAAN,CAAStD,IAAT,CAAcmE,KAAd,CAAT;AACD,KAFM,MAEA;AACLE,MAAAA,MAAM,GAAG,UAASN,EAAT,EAAa;AACpB,eAAOI,KAAK,KAAKJ,EAAjB;AACD,OAFD;AAGD;;AAED,WAAOK,SAAS,CAAClD,KAAV,CAAgBgD,QAAQ,CAAC,IAAD,EAAOG,MAAP,CAAxB,CAAP;AACD,GAnBD;AAoBD,CArBD;;AAuBAhE,OAAO,CAACF,MAAR,GAAiB8D,gBAAgB,CAAClE,CAAC,CAACI,MAAH,CAAjC;AACAE,OAAO,CAACkE,GAAR,GAAcN,gBAAgB,CAAClE,CAAC,CAACG,MAAH,CAA9B;;AAEAG,OAAO,CAACmE,GAAR,GAAc,UAASjE,kBAAT,EAA6B;AACzC,MAAIkE,IAAI,GAAG,IAAX;AACA,SAAOpE,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoB,IAApB,EAA0B,YAAW;AAC1C,WAAOwC,IAAI,CAACvD,KAAL,CAAW,IAAX,EAAiBZ,IAAjB,CAAsBC,kBAAtB,EAA0Cc,MAA1C,GAAmD,CAA1D;AACD,GAFM,CAAP;AAGD,CALD;;AAOAhB,OAAO,CAACqE,KAAR,GAAgB,YAAW;AACzB,SAAO,KAAKrD,MAAL,GAAc,CAAd,GAAkB,KAAKH,KAAL,CAAW,KAAK,CAAL,CAAX,CAAlB,GAAwC,IAA/C;AACD,CAFD;;AAIAb,OAAO,CAACsE,IAAR,GAAe,YAAW;AACxB,SAAO,KAAKtD,MAAL,GAAc,CAAd,GAAkB,KAAKH,KAAL,CAAW,KAAK,KAAKG,MAAL,GAAc,CAAnB,CAAX,CAAlB,GAAsD,IAA7D;AACD,CAFD,C,CAIA;;;AACAhB,OAAO,CAACuE,EAAR,GAAa,UAASf,CAAT,EAAY;AACvBA,EAAAA,CAAC,GAAG,CAACA,CAAL,CADuB,CAGvB;;AACA,MAAIA,CAAC,KAAK,CAAN,IAAW,KAAKxC,MAAL,IAAe,CAA9B,EAAiC,OAAO,IAAP;AAEjC,MAAIwC,CAAC,GAAG,CAAR,EAAWA,CAAC,GAAG,KAAKxC,MAAL,GAAcwC,CAAlB;AACX,SAAO,KAAKA,CAAL,IAAU,KAAK3C,KAAL,CAAW,KAAK2C,CAAL,CAAX,CAAV,GAAgC,KAAK3C,KAAL,CAAW,EAAX,CAAvC;AACD,CARD,C,CAUA;;;AACAb,OAAO,CAACY,GAAR,GAAc,UAAS4C,CAAT,EAAY;AACxB,MAAIA,CAAC,IAAI,IAAT,EAAe;AACb,WAAOgB,KAAK,CAACC,SAAN,CAAgBC,KAAhB,CAAsB9C,IAAtB,CAA2B,IAA3B,CAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAK4B,CAAC,GAAG,CAAJ,GAAS,KAAKxC,MAAL,GAAcwC,CAAvB,GAA4BA,CAAjC,CAAP;AACD;AACF,CAND,C,CAQA;;;AACAxD,OAAO,CAAC2E,KAAR,GAAgB,UAASC,gBAAT,EAA2B;AACzC,MAAIC,SAAJ,EAAeC,MAAf;;AAEA,MAAInD,SAAS,CAACX,MAAV,KAAqB,CAAzB,EAA4B;AAC1B6D,IAAAA,SAAS,GAAG,KAAKxD,MAAL,GAAcd,QAAd,EAAZ;AACAuE,IAAAA,MAAM,GAAG,KAAK,CAAL,CAAT;AACD,GAHD,MAGO,IAAI,OAAOF,gBAAP,KAA4B,QAAhC,EAA0C;AAC/CC,IAAAA,SAAS,GAAG,KAAKhE,KAAL,CAAW+D,gBAAX,CAAZ;AACAE,IAAAA,MAAM,GAAG,KAAK,CAAL,CAAT;AACD,GAHM,MAGA;AACLD,IAAAA,SAAS,GAAG,IAAZ;AACAC,IAAAA,MAAM,GAAGF,gBAAgB,CAACjE,OAAjB,GAA2BiE,gBAAgB,CAAC,CAAD,CAA3C,GAAiDA,gBAA1D;AACD;;AAED,SAAOC,SAAS,CAACjE,GAAV,GAAgBa,OAAhB,CAAwBqD,MAAxB,CAAP;AACD,CAfD;;AAiBA9E,OAAO,CAAC0E,KAAR,GAAgB,YAAW;AACzB,SAAO,KAAK7D,KAAL,CAAW,GAAG6D,KAAH,CAASrB,KAAT,CAAe,IAAf,EAAqB1B,SAArB,CAAX,CAAP;AACD,CAFD;;AAIA,SAASK,eAAT,CAAyB+C,IAAzB,EAA+B1E,IAA/B,EAAqCiB,QAArC,EAA+C0D,KAA/C,EAAsD;AACpD,MAAI7E,KAAK,GAAG,EAAZ;;AACA,SAAOE,IAAI,IAAIF,KAAK,CAACa,MAAN,GAAegE,KAA9B,EAAqC;AACnC,QAAI,CAAC1D,QAAD,IAAatB,OAAO,CAACF,MAAR,CAAe8B,IAAf,CAAoB,CAACvB,IAAD,CAApB,EAA4BiB,QAA5B,EAAsCyD,IAAtC,EAA4C/D,MAA7D,EAAqE;AACnEb,MAAAA,KAAK,CAACuB,IAAN,CAAWrB,IAAX;AACD;;AACDA,IAAAA,IAAI,GAAGA,IAAI,CAACgB,MAAZ;AACD;;AACD,SAAOlB,KAAP;AACD,C,CAED;AACA;;;AACAH,OAAO,CAACiF,GAAR,GAAc,YAAW;AACvB,SAAO,KAAKC,UAAL,IAAmB,KAAKrE,KAAL,CAAW,EAAX,CAA1B;AACD,CAFD;;AAIAb,OAAO,CAACmF,GAAR,GAAc,UAASC,KAAT,EAAgBjE,OAAhB,EAAyB;AACrC,MAAIkE,SAAS,GAAG,KAAKxE,KAAL,CAAWuE,KAAX,EAAkBjE,OAAlB,CAAhB;;AACA,MAAIgC,QAAQ,GAAG5D,UAAU,CAAC8F,SAAS,CAACzE,GAAV,GAAgBN,MAAhB,CAAuB,KAAKM,GAAL,EAAvB,CAAD,CAAzB;;AAEA,OAAK,IAAI4C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,QAAQ,CAACnC,MAA7B,EAAqC,EAAEwC,CAAvC,EAA0C;AACxC6B,IAAAA,SAAS,CAAC7B,CAAD,CAAT,GAAeL,QAAQ,CAACK,CAAD,CAAvB;AACD;;AACD6B,EAAAA,SAAS,CAACrE,MAAV,GAAmBmC,QAAQ,CAACnC,MAA5B;AAEA,SAAOqE,SAAP;AACD,CAVD,C,CAYA;AACA;;;AACArF,OAAO,CAACsF,OAAR,GAAkB,UAAShE,QAAT,EAAmB;AACnC,SAAO,KAAK6D,GAAL,CACLxD,SAAS,CAACX,MAAV,GAAmB,KAAKkE,UAAL,CAAgBpF,MAAhB,CAAuBwB,QAAvB,CAAnB,GAAsD,KAAK4D,UADtD,CAAP;AAGD,CAJD","sourcesContent":["var select = require('css-select'),\n    utils = require('../utils'),\n    domEach = utils.domEach,\n    uniqueSort = require('htmlparser2').DomUtils.uniqueSort,\n    isTag = utils.isTag,\n    _ = {\n      bind: require('lodash/bind'),\n      forEach: require('lodash/forEach'),\n      reject: require('lodash/reject'),\n      filter: require('lodash/filter'),\n      reduce: require('lodash/reduce')\n    };\n\nexports.find = function(selectorOrHaystack) {\n  var elems = _.reduce(this, function(memo, elem) {\n    return memo.concat(_.filter(elem.children, isTag));\n  }, []);\n  var contains = this.constructor.contains;\n  var haystack;\n\n  if (selectorOrHaystack && typeof selectorOrHaystack !== 'string') {\n    if (selectorOrHaystack.cheerio) {\n      haystack = selectorOrHaystack.get();\n    } else {\n      haystack = [selectorOrHaystack];\n    }\n\n    return this._make(haystack.filter(function(elem) {\n      var idx, len;\n      for (idx = 0, len = this.length; idx < len; ++idx) {\n        if (contains(this[idx], elem)) {\n          return true;\n        }\n      }\n    }, this));\n  }\n\n  var options = {__proto__: this.options, context: this.toArray()};\n\n  return this._make(select(selectorOrHaystack, elems, options));\n};\n\n// Get the parent of each element in the current set of matched elements,\n// optionally filtered by a selector.\nexports.parent = function(selector) {\n  var set = [];\n\n  domEach(this, function(idx, elem) {\n    var parentElem = elem.parent;\n    if (parentElem && set.indexOf(parentElem) < 0) {\n      set.push(parentElem);\n    }\n  });\n\n  if (arguments.length) {\n    set = exports.filter.call(set, selector, this);\n  }\n\n  return this._make(set);\n};\n\nexports.parents = function(selector) {\n  var parentNodes = [];\n\n  // When multiple DOM elements are in the original set, the resulting set will\n  // be in *reverse* order of the original elements as well, with duplicates\n  // removed.\n  this.get().reverse().forEach(function(elem) {\n    traverseParents(this, elem.parent, selector, Infinity)\n      .forEach(function(node) {\n        if (parentNodes.indexOf(node) === -1) {\n          parentNodes.push(node);\n        }\n      }\n    );\n  }, this);\n\n  return this._make(parentNodes);\n};\n\nexports.parentsUntil = function(selector, filter) {\n  var parentNodes = [], untilNode, untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.parents().toArray(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.toArray();\n  } else if (selector) {\n    untilNode = selector;\n  }\n\n  // When multiple DOM elements are in the original set, the resulting set will\n  // be in *reverse* order of the original elements as well, with duplicates\n  // removed.\n\n  this.toArray().reverse().forEach(function(elem) {\n    while ((elem = elem.parent)) {\n      if ((untilNode && elem !== untilNode) ||\n        (untilNodes && untilNodes.indexOf(elem) === -1) ||\n        (!untilNode && !untilNodes)) {\n        if (isTag(elem) && parentNodes.indexOf(elem) === -1) { parentNodes.push(elem); }\n      } else {\n        break;\n      }\n    }\n  }, this);\n\n  return this._make(filter ? select(filter, parentNodes, this.options) : parentNodes);\n};\n\n// For each element in the set, get the first element that matches the selector\n// by testing the element itself and traversing up through its ancestors in the\n// DOM tree.\nexports.closest = function(selector) {\n  var set = [];\n\n  if (!selector) {\n    return this._make(set);\n  }\n\n  domEach(this, function(idx, elem) {\n    var closestElem = traverseParents(this, elem, selector, 1)[0];\n\n    // Do not add duplicate elements to the set\n    if (closestElem && set.indexOf(closestElem) < 0) {\n      set.push(closestElem);\n    }\n  }.bind(this));\n\n  return this._make(set);\n};\n\nexports.next = function(selector) {\n  if (!this[0]) { return this; }\n  var elems = [];\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.next)) {\n      if (isTag(elem)) {\n        elems.push(elem);\n        return;\n      }\n    }\n  });\n\n  return selector ?\n    exports.filter.call(elems, selector, this) :\n    this._make(elems);\n};\n\nexports.nextAll = function(selector) {\n  if (!this[0]) { return this; }\n  var elems = [];\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.next)) {\n      if (isTag(elem) && elems.indexOf(elem) === -1) {\n        elems.push(elem);\n      }\n    }\n  });\n\n  return selector ?\n    exports.filter.call(elems, selector, this) :\n    this._make(elems);\n};\n\nexports.nextUntil = function(selector, filterSelector) {\n  if (!this[0]) { return this; }\n  var elems = [], untilNode, untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.nextAll().get(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.get();\n  } else if (selector) {\n    untilNode = selector;\n  }\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.next)) {\n      if ((untilNode && elem !== untilNode) ||\n        (untilNodes && untilNodes.indexOf(elem) === -1) ||\n        (!untilNode && !untilNodes)) {\n        if (isTag(elem) && elems.indexOf(elem) === -1) {\n          elems.push(elem);\n        }\n      } else {\n        break;\n      }\n    }\n  });\n\n  return filterSelector ?\n    exports.filter.call(elems, filterSelector, this) :\n    this._make(elems);\n};\n\nexports.prev = function(selector) {\n  if (!this[0]) { return this; }\n  var elems = [];\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.prev)) {\n      if (isTag(elem)) {\n        elems.push(elem);\n        return;\n      }\n    }\n  });\n\n  return selector ?\n    exports.filter.call(elems, selector, this) :\n    this._make(elems);\n};\n\nexports.prevAll = function(selector) {\n  if (!this[0]) { return this; }\n  var elems = [];\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.prev)) {\n      if (isTag(elem) && elems.indexOf(elem) === -1) {\n        elems.push(elem);\n      }\n    }\n  });\n\n  return selector ?\n    exports.filter.call(elems, selector, this) :\n    this._make(elems);\n};\n\nexports.prevUntil = function(selector, filterSelector) {\n  if (!this[0]) { return this; }\n  var elems = [], untilNode, untilNodes;\n\n  if (typeof selector === 'string') {\n    untilNode = select(selector, this.prevAll().get(), this.options)[0];\n  } else if (selector && selector.cheerio) {\n    untilNodes = selector.get();\n  } else if (selector) {\n    untilNode = selector;\n  }\n\n  _.forEach(this, function(elem) {\n    while ((elem = elem.prev)) {\n      if ((untilNode && elem !== untilNode) ||\n        (untilNodes && untilNodes.indexOf(elem) === -1) ||\n        (!untilNode && !untilNodes)) {\n        if (isTag(elem) && elems.indexOf(elem) === -1) {\n          elems.push(elem);\n        }\n      } else {\n        break;\n      }\n    }\n  });\n\n  return filterSelector ?\n    exports.filter.call(elems, filterSelector, this) :\n    this._make(elems);\n};\n\nexports.siblings = function(selector) {\n  var parent = this.parent();\n\n  var elems = _.filter(\n    parent ? parent.children() : this.siblingsAndMe(),\n    _.bind(function(elem) { return isTag(elem) && !this.is(elem); }, this)\n  );\n\n  if (selector !== undefined) {\n    return exports.filter.call(elems, selector, this);\n  } else {\n    return this._make(elems);\n  }\n};\n\nexports.children = function(selector) {\n\n  var elems = _.reduce(this, function(memo, elem) {\n    return memo.concat(_.filter(elem.children, isTag));\n  }, []);\n\n  if (selector === undefined) return this._make(elems);\n\n  return exports.filter.call(elems, selector, this);\n};\n\nexports.contents = function() {\n  return this._make(_.reduce(this, function(all, elem) {\n    all.push.apply(all, elem.children);\n    return all;\n  }, []));\n};\n\nexports.each = function(fn) {\n  var i = 0, len = this.length;\n  while (i < len && fn.call(this[i], i, this[i]) !== false) ++i;\n  return this;\n};\n\nexports.map = function(fn) {\n  return this._make(_.reduce(this, function(memo, el, i) {\n    var val = fn.call(el, i, el);\n    return val == null ? memo : memo.concat(val);\n  }, []));\n};\n\nvar makeFilterMethod = function(filterFn) {\n  return function(match, container) {\n    var testFn;\n    container = container || this;\n\n    if (typeof match === 'string') {\n      testFn = select.compile(match, container.options);\n    } else if (typeof match === 'function') {\n      testFn = function(el, i) {\n        return match.call(el, i, el);\n      };\n    } else if (match.cheerio) {\n      testFn = match.is.bind(match);\n    } else {\n      testFn = function(el) {\n        return match === el;\n      };\n    }\n\n    return container._make(filterFn(this, testFn));\n  };\n};\n\nexports.filter = makeFilterMethod(_.filter);\nexports.not = makeFilterMethod(_.reject);\n\nexports.has = function(selectorOrHaystack) {\n  var that = this;\n  return exports.filter.call(this, function() {\n    return that._make(this).find(selectorOrHaystack).length > 0;\n  });\n};\n\nexports.first = function() {\n  return this.length > 1 ? this._make(this[0]) : this;\n};\n\nexports.last = function() {\n  return this.length > 1 ? this._make(this[this.length - 1]) : this;\n};\n\n// Reduce the set of matched elements to the one at the specified index.\nexports.eq = function(i) {\n  i = +i;\n\n  // Use the first identity optimization if possible\n  if (i === 0 && this.length <= 1) return this;\n\n  if (i < 0) i = this.length + i;\n  return this[i] ? this._make(this[i]) : this._make([]);\n};\n\n// Retrieve the DOM elements matched by the jQuery object.\nexports.get = function(i) {\n  if (i == null) {\n    return Array.prototype.slice.call(this);\n  } else {\n    return this[i < 0 ? (this.length + i) : i];\n  }\n};\n\n// Search for a given element from among the matched elements.\nexports.index = function(selectorOrNeedle) {\n  var $haystack, needle;\n\n  if (arguments.length === 0) {\n    $haystack = this.parent().children();\n    needle = this[0];\n  } else if (typeof selectorOrNeedle === 'string') {\n    $haystack = this._make(selectorOrNeedle);\n    needle = this[0];\n  } else {\n    $haystack = this;\n    needle = selectorOrNeedle.cheerio ? selectorOrNeedle[0] : selectorOrNeedle;\n  }\n\n  return $haystack.get().indexOf(needle);\n};\n\nexports.slice = function() {\n  return this._make([].slice.apply(this, arguments));\n};\n\nfunction traverseParents(self, elem, selector, limit) {\n  var elems = [];\n  while (elem && elems.length < limit) {\n    if (!selector || exports.filter.call([elem], selector, self).length) {\n      elems.push(elem);\n    }\n    elem = elem.parent;\n  }\n  return elems;\n}\n\n// End the most recent filtering operation in the current chain and return the\n// set of matched elements to its previous state.\nexports.end = function() {\n  return this.prevObject || this._make([]);\n};\n\nexports.add = function(other, context) {\n  var selection = this._make(other, context);\n  var contents = uniqueSort(selection.get().concat(this.get()));\n\n  for (var i = 0; i < contents.length; ++i) {\n    selection[i] = contents[i];\n  }\n  selection.length = contents.length;\n\n  return selection;\n};\n\n// Add the previous set of elements on the stack to the current set, optionally\n// filtered by a selector.\nexports.addBack = function(selector) {\n  return this.add(\n    arguments.length ? this.prevObject.filter(selector) : this.prevObject\n  );\n};\n"]},"metadata":{},"sourceType":"script"}